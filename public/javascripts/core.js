window.GOVUK=window.GOVUK||{},window.GOVUK.registerToVote={},function(){"use strict";var ToggleObj,OptionalInformation,stageprompt,sendGoogleAnalyticsEvent,$searchFocus,root=this,$=root.jQuery,GOVUK=root.GOVUK;stageprompt=function(){var setup,setupForGoogleAnalytics,splitAction;return splitAction=function(action){var parts=action.split(":");return parts.length<=3?parts:[parts.shift(),parts.shift(),parts.join(":")]},setup=function(analyticsCallback){var journeyStage=$("[data-journey]").attr("data-journey"),journeyHelpers=$("[data-journey-click]");journeyStage&&analyticsCallback.apply(null,splitAction(journeyStage)),journeyHelpers.on("click",function(){analyticsCallback.apply(null,splitAction($(this).data("journey-click")))})},setupForGoogleAnalytics=function(){setup(GOVUK.performance.sendGoogleAnalyticsEvent)},{setup:setup,setupForGoogleAnalytics:setupForGoogleAnalytics}}(),sendGoogleAnalyticsEvent=function(category,event,label){window.ga&&"function"==typeof window.ga?ga("send","event",category,event,label):_gaq.push(["_trackEvent",category,event,label,void 0,!0])},GOVUK.performance=GOVUK.performance||{},GOVUK.performance.stageprompt=stageprompt,GOVUK.performance.sendGoogleAnalyticsEvent=sendGoogleAnalyticsEvent,ToggleObj=function(elm,toggleClass){elm&&(this.$content=$(elm),this.toggleClass=toggleClass+"-open",this.setup()&&this.bindEvents())},ToggleObj.prototype.setAccessibilityAPI=function(state){"hidden"===state?(this.$content.attr("aria-hidden",!0),this.$content.attr("aria-expanded",!1)):(this.$content.attr("aria-hidden",!1),this.$content.attr("aria-expanded",!0))},ToggleObj.prototype.toggle=function(){"none"===this.$content.css("display")?(this.$content.addClass(this.toggleClass),this.setAccessibilityAPI("visible"),this.$toggle.removeClass("toggle-closed"),this.$toggle.addClass("toggle-open"),$(document).trigger("toggle.open",{$toggle:this.$toggle})):(this.$content.removeClass(this.toggleClass),this.setAccessibilityAPI("hidden"),this.$toggle.removeClass("toggle-open"),this.$toggle.addClass("toggle-closed"),$(document).trigger("toggle.closed",{$toggle:this.$toggle}))},ToggleObj.prototype.setInitialState=function(){this.$content.hasClass(this.toggleClass)&&(this.$toggle.addClass("toggle-open"),this.$toggle.removeClass("toggle-closed"),this.setAccessibilityAPI("visible"))},OptionalInformation=function(){GOVUK.registerToVote.ToggleObj.apply(this,arguments)},$.extend(OptionalInformation.prototype,new ToggleObj),OptionalInformation.prototype.setup=function(){var toggleText,contentId=this.$content.attr("id");return this.$heading=this.$content.find("h1,h2,h3,h4").first(),toggleText=this.$content.data("toggleText"),void 0===toggleText?!1:(this.$toggle=$('<a href="#" class="toggle toggle-closed">'+toggleText+"</a>"),contentId&&this.$toggle.attr("aria-controls",contentId),this.$toggle.insertBefore(this.$content),this.$heading.addClass("visuallyhidden"),this.setInitialState(),!0)},OptionalInformation.prototype.bindEvents=function(){var _this=this;this.$toggle.on("click",function(){return _this.toggle(),!1})},GOVUK.registerToVote.ToggleObj=ToggleObj,GOVUK.registerToVote.OptionalInformation=OptionalInformation,$(".js-header-toggle").on("click",function(e){e.preventDefault(),$($(e.target).attr("href")).toggleClass("js-visible"),$(this).toggleClass("js-hidden")}),$searchFocus=$(".js-search-focus"),$searchFocus.each(function(i,el){""!==$(el).val()&&$(el).addClass("focus")}),$searchFocus.on("focus",function(e){$(e.target).addClass("focus")}),$searchFocus.on("blur",function(e){""===$(e.target).val()&&$(e.target).removeClass("focus")}),$(".help-content").each(function(idx,elm){new GOVUK.registerToVote.OptionalInformation(elm,"help-content")})}.call(this);