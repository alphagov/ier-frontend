@(implicit formData: uk.gov.gds.ier.validation.InProgressForm)

@import uk.gov.gds.ier.form.FormHelpers._

@countryValue(countries:Option[List[String]], idx:Int) = {
  @(countries match {
    case Some(n) =>  n(idx)
    case None =>  ""
  })
}

@layouts.questionHeader("What is your nationality?", "", 1)
        <p>If you have dual nationality, select all options that are relevant to you.</p>
        <fieldset>
          @check(keys.nationality.nationalities.item(0), label = "I am British", value = "British")
          @check(keys.nationality.nationalities.item(1), label = "I am Irish", value = "Irish")
          @check(keys.nationality.hasOtherCountry, label = "I am a citizen of another country", value = "true")
          <div class="optional-section" data-condition="@keys.nationality.hasOtherCountry.asId()">
              @text(keys.nationality.otherCountries.item(0), label = "Which country?", inputAttributes = Map('class -> "country-autocomplete"))
              @if(formData.getOtherCountries.exists(_.size > 1)) {
              <p class="duplication-intro" style="display: none">If you have dual nationality <a class="duplicate-control-initial" href="#" data-field="@keys.nationality.otherCountries.item(0).asId()">add another country</a>.</p>
              } else {
              <p class="duplication-intro">If you have dual nationality <a class="duplicate-control-initial" href="#" data-field="@keys.nationality.otherCountries.item(0).asId()">add another country</a>.</p>
              }
              @keys.nationality.otherCountries.each(1) { (id, i) =>
              <div class="added-country">
                  <label for="nationality_otherCountries[@(i)]" class="  country-label">
                      Country @(i)
                  </label>
                  <a href="#" class="remove-field" data-field="nationality_otherCountries[@(i)]">Remove<span class="visuallyhidden"> Country @(i)</span></a>
                  <input type="text" id="nationality_otherCountries[@(i)]" name="nationality.otherCountries[@(i)]" value="@countryValue(formData.getOtherCountries, i)" class="text country-autocomplete">
              </div>
              }
              @if(formData.getOtherCountries.exists(_.size > 1)) {
              <a class="duplicate-control" href="#">Add another country</a>
              }
          </div>
        </fieldset>
        <div class="help-content">
          <h2>Help</h2>
          <p>If you're not sure about your nationality, try to find out from an official document like a passport or national ID card.</p>
          <p>We need to know your nationality so we can work out which elections you're entitled to vote in. If you canâ€™t confirm your nationality, you'll have to send copies of identity documents through the post.</p>
          <div class="optional-section">
            <h3>I can't provide my nationality</h3>
            @textArea(keys.nationality.noNationalityReason, label = "Why can't you provide your nationality?", inputAttributes = Map('class -> "small"))
          </div>
        </div>
@validationMessage(formData(keys.nationality))
@validationMessage(formData(keys.nationality.nationalities))
        <input type="submit" class="button next" value="Continue" />
